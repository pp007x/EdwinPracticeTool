{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/steph/Documents/EdwinPracticeTool/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _defineProperty from\"C:/Users/steph/Documents/EdwinPracticeTool/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/steph/Documents/EdwinPracticeTool/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/steph/Documents/EdwinPracticeTool/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/steph/Documents/EdwinPracticeTool/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/steph/Documents/EdwinPracticeTool/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import styles from'../Css/ReactionForm.module.css';import config from'../config';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ReactionForm=function ReactionForm(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),questions=_useState2[0],setQuestions=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),answers=_useState4[0],setAnswers=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),userId=_useState6[0],setUserId=_useState6[1];var navigate=useNavigate();useEffect(function(){var fetchProfileAndQuestions=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,localConfig,profileResponse,questionsResponse;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;token=localStorage.getItem('token');localConfig={headers:{Authorization:\"Bearer \".concat(token)}};// Fetch the profile data\n_context.next=5;return axios.get(\"\".concat(config.API_BASE_URL,\"/api/Users/Profile\"),localConfig);case 5:profileResponse=_context.sent;_context.next=8;return axios.get(\"\".concat(config.API_BASE_URL,\"/api/ReactionForm?companyId=\").concat(profileResponse.data.companyId),localConfig);case 8:questionsResponse=_context.sent;// Store the UserId\nsetUserId(profileResponse.data.id);setQuestions(questionsResponse.data);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.error('Failed to fetch profile or questions:',_context.t0);case 16:case\"end\":return _context.stop();}},_callee,null,[[0,13]]);}));return function fetchProfileAndQuestions(){return _ref.apply(this,arguments);};}();fetchProfileAndQuestions();},[]);var handleAnswerChange=function handleAnswerChange(questionId,answerId){setAnswers(function(prevAnswers){return _objectSpread(_objectSpread({},prevAnswers),{},_defineProperty({},questionId,answerId));});};var calculateTotalScore=function calculateTotalScore(){var totalScoreD=0;var totalScoreI=0;var totalScoreS=0;var totalScoreC=0;var _iterator=_createForOfIteratorHelper(questions),_step;try{var _loop=function _loop(){var question=_step.value;var answerId=answers[question.id];if(answerId){var selectedAnswer=question.answers.find(function(answer){return answer.id===answerId;});if(selectedAnswer){totalScoreD+=selectedAnswer.scoreValueD;totalScoreI+=selectedAnswer.scoreValueI;totalScoreS+=selectedAnswer.scoreValueS;totalScoreC+=selectedAnswer.scoreValueC;}}};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}return{scoreValueD:totalScoreD,scoreValueI:totalScoreI,scoreValueS:totalScoreS,scoreValueC:totalScoreC,userId:userId};};var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event){var totalScore,token,localConfig,response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:event.preventDefault();totalScore=calculateTotalScore();_context2.prev=2;token=localStorage.getItem('token');localConfig={headers:{Authorization:\"Bearer \".concat(token)}};_context2.next=7;return axios.post(\"\".concat(config.API_BASE_URL,\"/api/TotalScores\"),totalScore,localConfig);case 7:response=_context2.sent;console.log(response.data);navigate('/dashboard');_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](2);console.error(\"Failed to submit total score:\",_context2.t0);case 15:case\"end\":return _context2.stop();}},_callee2,null,[[2,12]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:styles[\"form-control\"],children:questions.length>0?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[questions.map(function(question){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[question.questionText,/*#__PURE__*/_jsx(\"div\",{className:styles[\"answer-options\"],children:question.answers.map(function(answer){return/*#__PURE__*/_jsxs(\"label\",{htmlFor:answer.id.toString(),children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",id:answer.id.toString(),name:question.id.toString(),value:answer.id,onChange:function onChange(){return handleAnswerChange(question.id,answer.id);}}),answer.answerText]},answer.id);})})]})},question.id);}),/*#__PURE__*/_jsx(\"div\",{className:styles[\"button\"],children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit\"})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})});};export default ReactionForm;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","styles","config","jsx","_jsx","jsxs","_jsxs","ReactionForm","_useState","_useState2","_slicedToArray","questions","setQuestions","_useState3","_useState4","answers","setAnswers","_useState5","_useState6","userId","setUserId","navigate","fetchProfileAndQuestions","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","localConfig","profileResponse","questionsResponse","wrap","_callee$","_context","prev","next","localStorage","getItem","headers","Authorization","concat","get","API_BASE_URL","sent","data","companyId","id","t0","console","error","stop","apply","arguments","handleAnswerChange","questionId","answerId","prevAnswers","_objectSpread","_defineProperty","calculateTotalScore","totalScoreD","totalScoreI","totalScoreS","totalScoreC","_iterator","_createForOfIteratorHelper","_step","_loop","question","value","selectedAnswer","find","answer","scoreValueD","scoreValueI","scoreValueS","scoreValueC","s","n","done","err","e","f","handleSubmit","_ref2","_callee2","event","totalScore","response","_callee2$","_context2","preventDefault","post","log","_x","className","children","length","onSubmit","map","questionText","htmlFor","toString","type","name","onChange","answerText"],"sources":["C:/Users/steph/Documents/EdwinPracticeTool/frontend/src/components/ReactionForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport styles from '../Css/ReactionForm.module.css';\r\nimport config from '../config';\r\n\r\nconst ReactionForm = () => {\r\n  const [questions, setQuestions] = useState([]);\r\n  const [answers, setAnswers] = useState({});\r\n  const [userId, setUserId] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchProfileAndQuestions = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const localConfig = {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        };\r\n        \r\n        // Fetch the profile data\r\n        const profileResponse = await axios.get(`${config.API_BASE_URL}/api/Users/Profile`, localConfig);\r\n        \r\n        // Use the CompanyId from the profile data to fetch the questions\r\n        const questionsResponse = await axios.get(`${config.API_BASE_URL}/api/ReactionForm?companyId=${profileResponse.data.companyId}`, localConfig);\r\n        \r\n        // Store the UserId\r\n        setUserId(profileResponse.data.id);\r\n\r\n        setQuestions(questionsResponse.data);\r\n      } catch (error) {\r\n        console.error('Failed to fetch profile or questions:', error);\r\n      }\r\n    };\r\n    fetchProfileAndQuestions();\r\n  }, []);\r\n\r\n  const handleAnswerChange = (questionId, answerId) => {\r\n    setAnswers(prevAnswers => ({\r\n      ...prevAnswers,\r\n      [questionId]: answerId\r\n    }));\r\n  };\r\n\r\n  const calculateTotalScore = () => {\r\n    let totalScoreD = 0;\r\n    let totalScoreI = 0;\r\n    let totalScoreS = 0;\r\n    let totalScoreC = 0;\r\n\r\n    for (let question of questions) {\r\n      const answerId = answers[question.id];\r\n      if (answerId) {\r\n        const selectedAnswer = question.answers.find(answer => answer.id === answerId);\r\n        if (selectedAnswer) {\r\n          totalScoreD += selectedAnswer.scoreValueD;\r\n          totalScoreI += selectedAnswer.scoreValueI;\r\n          totalScoreS += selectedAnswer.scoreValueS;\r\n          totalScoreC += selectedAnswer.scoreValueC;\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      scoreValueD: totalScoreD,\r\n      scoreValueI: totalScoreI,\r\n      scoreValueS: totalScoreS,\r\n      scoreValueC: totalScoreC,\r\n      userId: userId\r\n    };\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n\r\n    const totalScore = calculateTotalScore();\r\n\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const localConfig = {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      };\r\n      const response = await axios.post(\r\n        `${config.API_BASE_URL}/api/TotalScores`,\r\n        totalScore,\r\n        localConfig\r\n      );\r\n      console.log(response.data);\r\n\r\n      navigate('/dashboard');\r\n    } catch (error) {\r\n      console.error(\"Failed to submit total score:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={styles[\"form-control\"]}>\r\n      {questions.length > 0 ? (\r\n        <form onSubmit={handleSubmit}>\r\n          {questions.map((question) => (\r\n            <div key={question.id}>\r\n              <label>\r\n                {question.questionText}\r\n                <div className={styles[\"answer-options\"]}>\r\n                  {question.answers.map((answer) => (\r\n                    <label htmlFor={answer.id.toString()} key={answer.id}>\r\n                      <input\r\n                        type=\"radio\"\r\n                        id={answer.id.toString()}\r\n                        name={question.id.toString()}\r\n                        value={answer.id}\r\n                        onChange={() => handleAnswerChange(question.id, answer.id)}\r\n                      />\r\n                      {answer.answerText}\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              </label>\r\n            </div>\r\n          ))}\r\n          <div className={styles[\"button\"]}>\r\n            <button type=\"submit\">Submit</button>\r\n          </div>\r\n        </form>\r\n      ) : (\r\n        <p>Loading...</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReactionForm;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}